#### 多视图，路由


为了增加详细信息视图，我们可以拓展index.html来同时包含两个视图的模板代码，但是这样会很快给我们带来巨大的麻烦。相反，我们要把index.html模板转变成“布局模板”。这是我们应用所有视图的通用模板。其他的“局部布局模板”随后根据当前的“路由”被充填入，从而形成一个完整视图展示给用户。

index.html:
* 移除了大部分代码，只保留了一个`<div>`同时带有`ng-view`属性
* `$route`服务通常是用来配合`ngView`来执行的，`ngView`通常是用来使用在index.html中。
* 为了使用`$route`服务必须先要安装`ngRoute`模块。*使用`ngRoute`模块需要事先加载`angular-route.js`*

```html
<!DOCTYPE html>
<html lang="en" ng-app="phonecatApp">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.css"/>
    <link rel="stylesheet" href="app.css"/>
    <script src="angular.min.js"></script>
    <script src="angular-route.min.js"></script>
    <script src="app.js"></script>
    <script src="controller.js"></script>
</head>
<body>
<div ng-view></div>
</body>
</html>
```

phone-list.html

```html
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2">
            <!--Sidebar content-->

            Search: <input ng-model="query">
            Sort by:
            <select ng-model="orderProp">
                <option value="name">Alphabetical</option>
                <option value="age">Newest</option>
            </select>

        </div>
        <div class="col-md-10">
            <!--Body content-->

            <ul class="phones">
                <li ng-repeat="phone in phones | filter:query | orderBy:orderProp" class="thumbnail">
                    <a href="#/phones/{{phone.id}}" class="thumb"><img ng-src="{{phone.imageUrl}}"></a>
                    <a href="#/phones/{{phone.id}}">{{phone.name}}</a>
                    <p>{{phone.snippet}}</p>
                </li>
            </ul>

        </div>
    </div>
</div>
```

phone-detail.html

```html
TBD: detail view for <span>{{phoneId}}</span>
```

app.js

AngularJS中应用的路由通过`$routeProvider`来声明，它是`$route`服务的提供者。

```javascript
var phonecatApp = angular.module('phonecatApp', [
    'ngRoute',
    'phonecatControllers'
]);

phonecatApp.config(['$routeProvider', function($routeProvider) {
    $routeProvider.
        when('/phones', {
            templateUrl: 'phone-list.html',
            controller: 'PhoneListCtrl'
        }).
        when('/phones/:phoneId', {
            templateUrl: 'phone-detail.html',
            controller: 'PhoneDetailCtrl'
        }).
        otherwise({
            redirectTo: '/phones'
        });
}]);
```

controller.js

```javascript
var phonecatControllers = angular.module('phonecatControllers', []);

phonecatControllers.controller('PhoneListCtrl', ['$scope', '$http', function($scope, $http){
    $http.get('data.json').success(function(data) {
        $scope.phones = data;
    });
    $scope.orderProp = 'age';
}]);

phonecatControllers.controller('PhoneDetailCtrl', ['$scope', '$routeParams', function($scope, $routeParams) {
    $scope.phoneId = $routeParams.phoneId;
}]);
```

data.json

```json
[
    {
        "id": "nexus-s",
        "imageUrl": "img/phones/nexus-s.0.jpg",
        "name": "Nexus S",
        "snippet": "Fast just got faster with Nexus S.",
        "age": 1
    },
    {
        "id": "motorola-xoom-with-wi-fi",
        "imageUrl": "img/phones/motorola-xoom-with-wi-fi.0.jpg",
        "name": "Motorola XOOM™ with Wi-Fi",
        "snippet": "The Next, Next Generation tablet.",
        "age": 2
    },
    {
        "id": "motorola-xoom",
        "imageUrl": "img/phones/motorola-xoom.0.jpg",
        "name": "MOTOROLA XOOM™",
        "snippet": "The Next, Next Generation tablet.",
        "age": 3
    }
]
```

###### 关于模块的定义

不使用依赖

```javascript
// 定义一个新模块，模块名为phonecatApp。
// 第二个参数是依赖模块列表，如果是[]则不需要依赖模块
// 在html中引入模块使用ng-app="phonecatApp"
var myModule = angular.module('phonecatApp', []);
```
使用依赖

```javascript
// 定义一个新模块,模块名为phonecatControllers
var myModule1 = angular.module('phonecatControllers', []);

// 定义模块phonecatApp，依赖两个模块ngRoute和phonecatControllers
// 其中ngRoute是ng提供的路由模块,phonecatControllers是刚刚定义的模块
var myModule2 = angular.module('phonecatApp', [
    'ngRoute',
    'phonecatControllers'
]);
```
